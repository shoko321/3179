{
    "$schema": "https://vega.github.io/schema/vega/v5.json",
    "width": 470,
    "height": 470,
    "autosize": "none",
    "padding":{"top": 23, "bottom": 30, "left": 80, "right": 35},
    "signals": [
      {"name": "radius", "update": "width / 2"},
      {
        "name": "country_select",
        "value": "Finland",
        "bind": {
          "input": "select",
          "options": [
            "Finland",
            "Denmark",
            "Iceland",
            "Switzerland",
            "Netherlands",
            "Luxembourg",
            "Sweden",
            "Norway",
            "Israel",
            "New Zealand",
            "Austria",
            "Australia",
            "Ireland",
            "Germany",
            "Canada",
            "United States of America",
            "United Kingdom",
            "Czechia",
            "Belgium",
            "France",
            "Bahrain",
            "Slovenia",
            "Costa Rica",
            "United Arab Emirates",
            "Saudi Arabia",
            "Taiwan Province of China",
            "Singapore",
            "Romania",
            "Spain",
            "Uruguay",
            "Italy",
            "Kosovo",
            "Malta",
            "Lithuania",
            "Slovakia",
            "Estonia",
            "Panama",
            "Brazil",
            "Guatemala",
            "Kazakhstan",
            "Cyprus",
            "Latvia",
            "Serbia",
            "Chile",
            "Nicaragua",
            "Mexico",
            "Croatia",
            "Poland",
            "El Salvador",
            "Kuwait",
            "Hungary",
            "Mauritius",
            "Uzbekistan",
            "Japan",
            "Honduras",
            "Portugal",
            "Argentina",
            "Greece",
            "South Korea",
            "Philippines",
            "Thailand",
            "Moldova",
            "Jamaica",
            "Kyrgyzstan",
            "Belarus",
            "Colombia",
            "Bosnia and Herzegovina",
            "Mongolia",
            "Dominican Republic",
            "Malaysia",
            "Bolivia",
            "China",
            "Paraguay",
            "Peru",
            "Montenegro",
            "Ecuador",
            "Vietnam",
            "Turkmenistan",
            "North Cyprus",
            "Russia",
            "Hong Kong S.A.R. of China",
            "Armenia",
            "Tajikistan",
            "Nepal",
            "Bulgaria",
            "Libya",
            "Indonesia",
            "Ivory Coast",
            "North Macedonia",
            "Albania",
            "South Africa",
            "Azerbaijan",
            "Gambia",
            "Bangladesh",
            "Laos",
            "Algeria",
            "Liberia",
            "Ukraine",
            "Congo",
            "Morocco",
            "Mozambique",
            "Cameroon",
            "Senegal",
            "Niger",
            "Georgia",
            "Gabon",
            "Iraq",
            "Venezuela",
            "Guinea",
            "Iran",
            "Ghana",
            "Turkey",
            "Burkina Faso",
            "Cambodia",
            "Benin",
            "Comoros",
            "Uganda",
            "Nigeria",
            "Kenya",
            "Tunisia",
            "Pakistan",
            "Palestinian Territories",
            "Mali",
            "Namibia",
            "Eswatini",
            "Myanmar",
            "Sri Lanka",
            "Madagascar",
            "Egypt",
            "Chad",
            "Ethiopia",
            "Yemen",
            "Mauritania",
            "Jordan",
            "Togo",
            "India",
            "Zambia",
            "Malawi",
            "Tanzania",
            "Sierra Leone",
            "Lesotho",
            "Botswana",
            "Rwanda",
            "Zimbabwe",
            "Lebanon",
            "Afghanistan"
          ],
          "labels": [
            "1: Finland",
            "2: Denmark",
            "3: Iceland",
            "4: Switzerland",
            "5: Netherlands",
            "6: Luxembourg",
            "7: Sweden",
            "8: Norway",
            "9: Israel",
            "10: New Zealand",
            "11: Austria",
            "12: Australia",
            "13: Ireland",
            "14: Germany",
            "15: Canada",
            "16: United States of America",
            "17: United Kingdom",
            "18: Czechia",
            "19: Belgium",
            "20: France",
            "21: Bahrain",
            "22: Slovenia",
            "23: Costa Rica",
            "24: United Arab Emirates",
            "25: Saudi Arabia",
            "26: Taiwan Province of China",
            "27: Singapore",
            "28: Romania",
            "29: Spain",
            "30: Uruguay",
            "31: Italy",
            "32: Kosovo",
            "33: Malta",
            "34: Lithuania",
            "35: Slovakia",
            "36: Estonia",
            "37: Panama",
            "38: Brazil",
            "39: Guatemala",
            "40: Kazakhstan",
            "41: Cyprus",
            "42: Latvia",
            "43: Serbia",
            "44: Chile",
            "45: Nicaragua",
            "46: Mexico",
            "47: Croatia",
            "48: Poland",
            "49: El Salvador",
            "50: Kuwait",
            "51: Hungary",
            "52: Mauritius",
            "53: Uzbekistan",
            "54: Japan",
            "55: Honduras",
            "56: Portugal",
            "57: Argentina",
            "58: Greece",
            "59: South Korea",
            "60: Philippines",
            "61: Thailand",
            "62: Moldova",
            "63: Jamaica",
            "64: Kyrgyzstan",
            "65: Belarus",
            "66: Colombia",
            "67: Bosnia and Herzegovina",
            "68: Mongolia",
            "69: Dominican Republic",
            "70: Malaysia",
            "71: Bolivia",
            "72: China",
            "73: Paraguay",
            "74: Peru",
            "75: Montenegro",
            "76: Ecuador",
            "77: Vietnam",
            "78: Turkmenistan",
            "79: North Cyprus",
            "80: Russia",
            "81: Hong Kong S.A.R. of China",
            "82: Armenia",
            "83: Tajikistan",
            "84: Nepal",
            "85: Bulgaria",
            "86: Libya",
            "87: Indonesia",
            "88: Ivory Coast",
            "89: North Macedonia",
            "90: Albania",
            "91: South Africa",
            "92: Azerbaijan",
            "93: Gambia",
            "94: Bangladesh",
            "95: Laos",
            "96: Algeria",
            "97: Liberia",
            "98: Ukraine",
            "99: Congo",
            "100: Morocco",
            "101: Mozambique",
            "102: Cameroon",
            "103: Senegal",
            "104: Niger",
            "105: Georgia",
            "106: Gabon",
            "107: Iraq",
            "108: Venezuela",
            "109: Guinea",
            "110: Iran",
            "111: Ghana",
            "112: Turkey",
            "113: Burkina Faso",
            "114: Cambodia",
            "115: Benin",
            "116: Comoros",
            "117: Uganda",
            "118: Nigeria",
            "119: Kenya",
            "120: Tunisia",
            "121: Pakistan",
            "122: Palestinian Territories",
            "123: Mali",
            "124: Namibia",
            "125: Eswatini",
            "126: Myanmar",
            "127: Sri Lanka",
            "128: Madagascar",
            "129: Egypt",
            "130: Chad",
            "131: Ethiopia",
            "132: Yemen",
            "133: Mauritania",
            "134: Jordan",
            "135: Togo",
            "136: India",
            "137: Zambia",
            "138: Malawi",
            "139: Tanzania",
            "140: Sierra Leone",
            "141: Lesotho",
            "142: Botswana",
            "143: Rwanda",
            "144: Zimbabwe",
            "145: Lebanon",
            "146: Afghanistan"
          ],
          "name": "Country: "
        }
      }
    ],
    "data": [
      {
        "name": "table",
        "url": "https://raw.githubusercontent.com/shoko321/3179/main/data_vis2/world-happiness-report-2022",
        "format": {"type": "csv", "delimiter": ","},
        "transform": [
          {
            "type": "filter",
            "expr": "datum.Country == country_select"
          }
        ]
      },
      {
        "name": "keys",
        "source": "table",
        "transform": [{"type": "aggregate", "groupby": ["Key"]}]
      }
    ],
    "scales": [
      {
        "name": "angular",
        "type": "point",
        "range": {"signal": "[-PI, PI]"},
        "padding": 0.5,
        "domain": {"data": "table", "field": "Key"}
      },
      {
        "name": "radial",
        "type": "linear",
        "range": {"signal": "[0, radius]"},
        "zero": true,
        "nice": false,
        "domain": [0, 1],
        "domainMin": 0
      },
      {
        "name": "color",
        "type": "ordinal",
        "domain": {"data": "table", "field": "Country"},
        "range": {"scheme": "darkred"}
      }
    ],
    "encode": {
      "enter": {
        "x": {"signal": "radius"},
        "y": {"signal": "radius"}}
    },
    "marks": [
      {
        "type": "group",
        "name": "categories",
        "zindex": 1,
        "from": {
          "facet": {"data": "table", "name": "facet", "groupby": ["Country"]}
        },
        "marks": [
          {
            "type": "line",
            "name": "category-line",
            "from": {"data": "facet"},
            "encode": {
              "enter": {
                "tooltip": {
                  "signal": "{'Country': datum.Country,'Key': datum.Key, 'Value': datum.Value}"
                },
                "interpolate": {"value": "linear-closed"},
                "x": {
                  "signal": "scale('radial', datum.Value) * cos(scale('angular', datum.Key))"
                },
                "y": {
                  "signal": "scale('radial', datum.Value) * sin(scale('angular', datum.Key))"
                },
                "stroke": {"scale": "color", "field": "Country"},
                "strokeWidth": {"value": 1},
                "fill": {"scale": "color", "field": "Country"},
                "fillOpacity": {"value": 0.4}
              }
            }
          },
          {
            "type": "text",
            "name": "value-text",
            "from": {"data": "category-line"},
            "encode": {
              "enter": {
                "x": {"signal": "datum.x"},
                "y": {"signal": "datum.y"},
                "text": {"signal": "format(datum.datum.Value, '.3f')"},
                "align": {"value": "center"},
                "baseline": {"value": "middle"},
                "fill": {"value": "black"},
                "fontSize": {"value": 13}
              }
            }
          }
        ]
      },
      
      {
        "type": "text",
        "name": "key-label",
        "from": {"data": "keys"},
        "zindex": 1,
        "encode": {
          "enter": {
            "x": {"signal": "(radius+7) * cos(scale('angular', datum.Key))"},
            "y": {"signal": "(radius+7) * sin(scale('angular', datum.Key))"},
            "text": {"field": "Key"},
            "align": [
              {
                "test": "abs(scale('angular', datum.Key)) > PI / 2",
                "value": "right",
                "padding": 20
              },
              {"value": "left"}
            ],
            "baseline": [
              {"test": "scale('angular', datum.Key) > 0", "value": "top"},
              {"test": "scale('angular', datum.Key) == 0", "value": "middle"},
              {"value": "bottom"}
            ],
            "fill": {"value": "black"},
            "fontWeight": {"value": "bold"},
            "fontSize": {"value": 14}
          }
        }
      },
      {
        "type": "rule",
        "name": "radial-grid",
        "from": {"data": "keys"},
        "zindex": 0,
        "encode": {
          "enter": {
            "x": {"value": 0},
            "y": {"value": 0},
            "x2": {"signal": "radius * cos(scale('angular', datum.Key))"},
            "y2": {"signal": "radius * sin(scale('angular', datum.Key))"},
            "stroke": {"value": "lightgray"},
            "strokeWidth": {"value": 1}
          }
        }
      },
      {
        "type": "line",
        "name": "outer-line",
        "from": {"data": "radial-grid"},
        "encode": {
          "enter": {
            "interpolate": {"value": "linear-closed"},
            "x": {"field": "x2"},
            "y": {"field": "y2"},
            "stroke": {"value": "lightgray"},
            "strokeWidth": {"value": 1}
          }
        }
      }
    ]
  }